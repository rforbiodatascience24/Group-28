---
title: "Microreport week 7"
author: "Group 29"
format:
  html:
    embed-resources: true
editor: visual
---

## Loading libraries

## Loading data

## Tidying data

```{r}
pca_fit <- biopsy %>% 
  select(where(is.numeric)) %>% # retain only numeric columns
  prcomp(scale = TRUE) # do PCA on scaled data
```

## Visual data inspection

## Variance explained

Uses function

```{r}
pca_fit %>%
  tidy(matrix = "eigenvalues")
```

The variance is plotted

```{r}
pca_fit %>%
  tidy(matrix = "eigenvalues") %>%
  ggplot(aes(PC, percent)) +
  geom_col(fill = "#56B4E9", alpha = 0.8) +
  scale_x_continuous(breaks = 1:9) +
  scale_y_continuous(
    labels = scales::percent_format(),
    expand = expansion(mult = c(0, 0.01))
  ) +
  theme_minimal_hgrid(12)
```
