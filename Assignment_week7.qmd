---
title: "Microreport week 7"
author: "Group 29"
format:
  html:
    embed-resources: true
editor: visual
---

## Loading libraries

## Loading data

```{r}
biopsy <- read_csv("https://wilkelab.org/classes/SDS348/data_sets/biopsy.csv")
```

## Tidying data

```{r}
pca_fit <- biopsy %>% 
  select(where(is.numeric)) %>% # retain only numeric columns
  prcomp(scale = TRUE) # do PCA on scaled data
```

## Visual data inspection

When performing PCA, we'll want to perform the following steps:

1.  Looking at the data in PC coordinates
2.  Looking at the rotation matrix
3.  Looking at the variance explained by each PC.

We'll start by

```{r}
pca_fit <- biopsy |> 
  select(where(is.numeric)) |>  # retain only numeric columns
  prcomp(scale = TRUE) # do PCA on scaled data
```

As an alternative to `scale = TRUE`, we could also have scaled the data by explicitly invoking the `scale()` function.

```{r}
pca_fit <- biopsy 
  select(where(is.numeric)) %>% # retain only numeric columns
  scale() %>% # scale data
  prcomp() # do PCA
```

## Variance explained

Uses function

```{r}
pca_fit %>%
  tidy(matrix = "eigenvalues")
```

The variance is plotted

```{r}
pca_fit %>%
  tidy(matrix = "eigenvalues") %>%
  ggplot(aes(PC, percent)) +
  geom_col(fill = "#56B4E9", alpha = 0.8) +
  scale_x_continuous(breaks = 1:9) +
  scale_y_continuous(
    labels = scales::percent_format(),
    expand = expansion(mult = c(0, 0.01))
  ) +
  theme_minimal_hgrid(12)
```
